<!DOCTYPE html>
<html>
<head>
    <title>Exemplo MQTT</title>
    
</head>
<body>
    <h1>Envio de Mensagem MQTT</h1>
    <button id="enviar">Enviar Mensagem MQTT</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
    <script>
        console.log('MQTT');

        // Defina o servidor MQTT e outras configurações
       
        var mqttTopic = "ifce"; // Tópico MQTT

        function enviarParaMQTT() {
            console.log('Entrou na função enviarParaMQTT'); // Mensagem de depuração

            const redValue = "2";

            // Configurar a conexão com o servidor MQTT
           const client = new Paho.MQTT.Client("ws://broker.hivemq.com", 8000, "client_id");


            // Defina a função de callback de conexão
            client.onConnectionLost = function(responseObject) {
                if (responseObject.errorCode !== 0) {
                    console.log("Conexão perdida: " + responseObject.errorMessage);
                }
            };

            // Conecte-se ao servidor MQTT
            client.connect({
                onSuccess: function() {
                    console.log("Conectado ao servidor MQTT");
                    const message = redValue;

                    // Publicar a mensagem no tópico desejado
                    client.publish(mqttTopic, message);
                },
                onFailure: function(err) {
                    console.log("Erro de conexão: " + err.errorMessage);
                }
            });
        }

        document.addEventListener("DOMContentLoaded", function () {
            const enviarButton = document.getElementById("enviar");
            enviarButton.addEventListener("click", function () {
                enviarParaMQTT(); // Chama a função quando o botão é clicado
            });
        });
    </script>
</body>
</html>
